
import streamlit as st
import pandas as pd

st.title("–ü–æ–∏—Å–∫ –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞–º")

uploaded_file = st.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª .ods", type=["ods"])

if uploaded_file:
    df = pd.read_excel(uploaded_file, engine='odf', header=1)
    df.columns = df.iloc[0].str.strip()
    df = df[1:]
    df.columns = df.columns.str.strip()
    df = df.rename(columns={
        "–î–æ–ª–∂–Ω–∏–∫": "–§–ò–û",
        "–°—É–º–º–∞ –¥–æ–ª–≥–∞": "–°—É–º–º–∞–î–æ–ª–≥–∞",
        "–û—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞": "–û—Å—Ç–∞—Ç–æ–∫–î–æ–ª–≥–∞",
        "–°—É–º–º–∞ –∏—Å–ø. —Å–±–æ—Ä–∞": "–ò—Å–ø–°–±–æ—Ä",
        "–û—Å—Ç–∞—Ç–æ–∫ –ø–æ –∏—Å–ø. —Å–±–æ—Ä—É": "–û—Å—Ç–∞—Ç–æ–∫–ò—Å–ø–°–±–æ—Ä–∞",
        "–í–∑—ã—Å–∫–∞—Ç–µ–ª—å": "–í–∑—ã—Å–∫–∞—Ç–µ–ª—å"
    })
    df = df.reset_index(drop=True)
    df = df[1:]  # –£–¥–∞–ª–∏–º —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö

    # –û—á–∏—Å—Ç–∏–º –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–µ–º –≤–∞–∂–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    df = df.rename(columns={
        "–î–æ–ª–∂–Ω–∏–∫": "–§–ò–û",
        "–°—É–º–º–∞ –¥–æ–ª–≥–∞": "–°—É–º–º–∞–î–æ–ª–≥–∞",
        "–û—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞": "–û—Å—Ç–∞—Ç–æ–∫–î–æ–ª–≥–∞",
        "–°—É–º–º–∞ –∏—Å–ø. —Å–±–æ—Ä–∞": "–ò—Å–ø–°–±–æ—Ä",
        "–û—Å—Ç–∞—Ç–æ–∫ –ø–æ –∏—Å–ø. —Å–±–æ—Ä—É": "–û—Å—Ç–∞—Ç–æ–∫–ò—Å–ø–°–±–æ—Ä–∞",
        "–í–∑—ã—Å–∫–∞—Ç–µ–ª—å": "–í–∑—ã—Å–∫–∞—Ç–µ–ª—å"
    })

    # –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–∏—Å–∫–∞
    search_fullname = st.text_input("–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ:")

    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    if search_fullname:
        results = df[df['–§–ò–û'].str.contains(search_fullname, case=False, na=False)]
    else:
        results = df

    # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    if not results.empty:
        for idx, row in results.iterrows():
            st.markdown(f"### üîç –î–æ–ª–∂–Ω–∏–∫: {row.get('–§–ò–û', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}")
            st.write(f"**–°—É–º–º–∞ –¥–æ–ª–≥–∞:** {row.get('–°—É–º–º–∞–î–æ–ª–≥–∞', '-')}")
            st.write(f"**–û—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞:** {row.get('–û—Å—Ç–∞—Ç–æ–∫–î–æ–ª–≥a', '-')}")
            st.write(f"**–°—É–º–º–∞ –∏—Å–ø. —Å–±–æ—Ä–∞:** {row.get('–ò—Å–ø–°–±–æ—Ä', '-')}")
            st.write(f"**–û—Å—Ç–∞—Ç–æ–∫ –ø–æ –∏—Å–ø. —Å–±–æ—Ä—É:** {row.get('–û—Å—Ç–∞—Ç–æ–∫–ò—Å–ø–°–±–æ—Ä–∞', '-')}")
            st.write(f"**–í–∑—ã—Å–∫–∞—Ç–µ–ª—å:** {row['–í–∑—ã—Å–∫–∞—Ç–µ–ª—å']}")
            st.markdown("---")
    else:
        st.info("–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.")
